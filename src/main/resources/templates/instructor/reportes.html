<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">

<head th:insert="~{/usuario/templates_usuario.html::head}"></head>

<body style="font-family: 'Segoe UI', sans-serif;">

	<header th:insert="~{/usuario/templates_usuario.html::header}"></header>

	<main style="background-color: rgba(0, 124, 88, 0.05); min-height: 100vh; margin-top: 100px;">

		<section class="section">
			<div class="container py-4">
				<div class="row">

					<!-- Panel lateral -->
					<div class="col-lg-3 mb-4">
						<div class="user-nav rounded shadow-sm p-3 bg-white text-center">
							<img th:src="@{/images/instructor.png}" alt="Instructor.img"
								style="width: 120px; border-radius: 50%; border: 2px solid #007C58;">
							<small class="text-muted"><b>Área:</b> <span>Mecánica</span></small>
							<div class="mt-2">
								<span class="badge bg-success px-3 py-2">Activo</span>
							</div>

							<nav class="nav flex-column mt-4">
								<a th:href="@{/instructor/nvasEntradas}" class="btn btn-outline-success btn-sm mt-2">
									<i class="bi bi-house me-2"></i> Últimas Entradas
								</a>
								<a th:href="@{/instructor/grupos}" class="btn btn-outline-success btn-sm mt-2">
									<i class="bi bi-people me-2"></i> Grupos
								</a>
								<a th:href="@{/instructor/reportes}" class="btn btn-success btn-sm mt-2">
									<i class="bi bi-clipboard-data me-2"></i> Reportes
								</a>
							</nav>
						</div>
					</div>

					<!-- Contenido principal - SOLO PERMISOS -->
					<div class="col-lg-9">

						<!-- Estadística -->
						<div class="row mb-4">
							<div class="col-md-12">
								<div class="card text-white bg-info">
									<div class="card-body text-center">
										<h1 th:text="${totalPermisos}">0</h1>
										<p class="mb-0 fs-5">Total de Permisos en el Sistema</p>
									</div>
								</div>
							</div>
						</div>

						<!-- Reporte de Permisos -->
						<div class="card">
							<div class="card-header bg-white d-flex justify-content-between align-items-center">
								<h5 class="card-title mb-0">
									<i class="bi bi-shield-check me-2"></i>Reporte de Permisos de Usuarios
								</h5>
								<span class="badge bg-info" th:text="${totalPermisos} + ' permisos'">0 permisos</span>
							</div>
							<div class="card-body">
								<div th:if="${permisos.empty}" class="text-center py-5">
									<i class="bi bi-shield-slash fs-1 text-muted"></i>
									<p class="text-muted mt-3">No hay permisos registrados en el sistema</p>
								</div>

								<div th:unless="${permisos.empty}" class="table-responsive">
									<table class="table table-striped table-hover">
										<thead class="table-info">
											<tr>
												<th>ID</th>
												<th>Tipo de Permiso</th>
												<th>Ruta</th>
												<th>Usuario</th>
												<th>Estado</th>
											</tr>
										</thead>
										<tbody>
											<tr th:each="permiso : ${permisos}">
												<td th:text="${permiso.id}">1</td>
												<td>
													<span th:text="${permiso.tipoPermiso}" class="badge"
														th:classappend="${permiso.tipoPermiso == 'ADMIN'} ? 'bg-danger' : 
                                                                         ${permiso.tipoPermiso == 'INSTRUCTOR'} ? 'bg-warning' : 'bg-secondary'">
														ADMIN
													</span>
												</td>
												<td>
													<code th:text="${permiso.rutaPermiso}" class="text-primary">
                                                        /admin/dashboard
                                                    </code>
												</td>
												<td>
													<span th:if="${permiso.usuario != null}"
														th:text="${permiso.usuario.nombre}" class="fw-bold">
														Juan Pérez
													</span>
													<span th:if="${permiso.usuario == null}"
														class="text-muted fst-italic">
														Sin usuario
													</span>
												</td>
												<td>
													<span class="badge bg-success">
														<i class="bi bi-check-circle me-1"></i>Activo
													</span>
												</td>
											</tr>
										</tbody>
									</table>
								</div>
							</div>
						</div>

						<!-- Resumen por Tipo de Permiso -->
						<div class="card mt-4">
							<div class="card-header bg-white">
								<h6 class="card-title mb-0">
									<i class="bi bi-pie-chart me-2"></i>Resumen por Tipo de Permiso
								</h6>
							</div>
							<div class="card-body">
								<div th:if="${!permisos.empty}">
									<div class="row">
										<div class="col-md-4 text-center">
											<div class="border rounded p-3">
												<h4 th:text="${#lists.size(#lists.select(permisos, '${permiso.tipoPermiso == \"
													ADMIN\"}'))}">0</h4>
												<span class="badge bg-danger">ADMIN</span>
											</div>
										</div>
										<div class="col-md-4 text-center">
											<div class="border rounded p-3">
												<h4 th:text="${#lists.size(#lists.select(permisos, '${permiso.tipoPermiso == \"
													INSTRUCTOR\"}'))}">0</h4>
												<span class="badge bg-warning">INSTRUCTOR</span>
											</div>
										</div>
										<div class="col-md-4 text-center">
											<div class="border rounded p-3">
												<h4 th:text="${#lists.size(#lists.select(permisos, '${permiso.tipoPermiso == \"
													APRENDIZ\"}'))}">0</h4>
												<span class="badge bg-secondary">APRENDIZ</span>
											</div>
										</div>
									</div>
								</div>
							</div>
						</div>

					</div>

				</div>
			</div>
		</section>

	</main>

	<div th:insert="~{/usuario/templates_usuario.html::footer}"></div>
	<div th:insert="~{/usuario/templates_usuario.html::jsFiles}"></div>

</body>

</html>