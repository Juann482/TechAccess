<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thymeleaf.org">

<head th:insert="~{/templates_usuario.html::head}"></head>

<meta charset="UTF-8">

<body style="font-family: 'Segoe UI', sans-serif;" class="index-page">

	<header id="header" class="header d-flex align-items-center justify-content-between fixed-top w-100"
		style="background-color: rgba(0, 96, 142, 0.75); box-shadow: 0 5px 3px rgba(0,0,0,0.2); z-index: 999;">
		<div class="container-fluid container-xl d-flex w-100 align-items-center justify-content-between">
			<h1 class="sitename m-0">
				<strong style="color:rgb(243, 243, 243);">TECH</strong>
				<span style="color:rgb(243, 243, 243);">ACCESS</span>
				<span style="color:rgb(189, 196, 202);">/</span>
				<span style="color:#ffffff;">SENA - CIMM CIUDADELA</span>
			</h1>

			<div class="user-profile d-flex align-items-center">
				<!--span class="me-2 text-white fw-bold" th:text="${instructor.nombre}">Instructor</span-->
				<div class="dropdown">
					<a class="d-flex align-items-center text-decoration-none text-white" dropdown-toggle
						data-bs-toggle="dropdown">
						<i class="bi bi-person-circle fs-4"></i>
					</a>
					<ul class="dropdown-menu dropdown-menu-end">
						<li><a class="dropdown-item" th:href="@{/instructor/Inicio}"><i
									class="bi bi-person me-2"></i>Perfil</a>
						</li>
						<li><a class="dropdown-item" th:href="@{/logout}"><i
									class="bi bi-box-arrow-right me-2"></i>Cerrar sesión</a></li>
					</ul>
				</div>
			</div>
		</div>
	</header>

	<Fondo de video>
		<div class="video-container2 position-fixed top-0 start-0 w-100 h-100" style="z-index:-1;">
			<video class="video-background2 w-100 h-100 object-fit-cover" autoplay muted loop>
				<source src="https://videos.pexels.com/video-files/7946210/7946210-uhd_1440_2732_30fps.mp4">
				Error al cargar el video.
			</video>
		</div>

		<!-- Contenido principal -->
		<main class="main d-flex flex-column justify-content-between"
			style="background-color: rgba(0, 128, 192, 0.05); min-height: 100vh; margin-top: 100px;">

			<section class="section" style="background-color:rgba(235, 234, 231, 0.87)">

				<div class="container py-4">
					<div class="row">

						<!-- Panel lateral -->
						<div class="col-lg-3 mb-4">
							<div class="user-nav rounded shadow-sm p-3 bg-white text-center">
								<img th:src="@{/images/instructor.png}" alt="Instructor.img"
									style="width: 120px; border-radius: 50%; border: 2px solid rgb(0, 128, 192);">
								<!--h5 class="mt-2 mb-0" th:text="${instructor.nombre}">Instructor</h5-->
								<small class="text-muted"><b>Área:</b> <span>Mecánica</span></small>
								<div class="mt-2">
									<span class="badge bg-success bg-opacity-10 text-success px-3 py-2">Activo</span>
								</div>

								<nav class="nav flex-column mt-4">
									<a th:href="@{/instructor/nvasEntradas}" class="btn btn-outline-info btn-sm mt-2">
										<i class="bi bi-house me-2 text-info"></i> Últimas Entradas
									</a>
									<a th:href="@{/instructor/grupos}" class="btn btn-outline-info btn-sm mt-2">
										<i class="bi bi-people me-2 text-success"></i> Grupos
									</a>
									<a th:href="@{/instructor/reportes}" class="btn btn-outline-info btn-sm mt-2">
										<i class="bi bi-clipboard-data me-2 text-success"></i> Reportes
									</a>
								</nav>
							</div>
						</div>

						<!-- Contenido principal dinámico -->
						<div class="col-lg-9">
							<div id="contenido" class="access-card bg-white shadow-sm rounded p-4"
								style="opacity: 0.9;">

								<!-- Mostrar TABLA si hay datos -->
								<div th:if="${accesos != null and !accesos.empty}">
									<div class="d-flex justify-content-between align-items-center mb-3">
										<div>
											<h4 class="text-muted mb-1">
												<i class="bi bi-clock-history me-2"></i><b> Últimas Entradas</b>
											</h4>
											<p class="text-muted mb-0"
												th:text="'Total de registros: ' + ${accesos.size()}">
												Registros de entradas recientes
											</p>
										</div>
										<a th:href="@{/instructor/nvasEntradas}" class="btn btn-outline-muted btn-sm">
											<i class="bi bi-arrow-clockwise me-1"></i> Actualizar
										</a>
									</div>

									<div class="card shadow-sm border-0">
										<div class="card-body p-0">
											<div class="table-responsive">
												<table class="table table-hover align-middle mb-0">
													<thead class="table-primary">
														<tr>
															<th class="border-0">
																<i class="bi bi-person me-1"></i> Estudiante
															</th>
															<!--th class="border-0">
															<i class="bi bi-geo-alt me-1"></i> Área
														</th-->
															<th class="border-0">
																<i class="bi bi-calendar me-1"></i> Hora Ingreso
															</th>
															<th class="border-0">
																<i class="bi bi-info-circle me-1"></i> Estado
															</th>
															<!--th class="border-0 text-center">
															<i class="bi bi-gear me-1"></i> Acciones
														</th-->
														</tr>
													</thead>
													<tbody>
														<tr th:each="entrada : ${accesos}" class="border-bottom">
															<td class="fw-medium"
																th:text="${entrada.usuario?.nombre} ?: 'NN'">
																Estudiante
															</td>
															<!--td th:text="${entrada.usuario?.rol} ?: 'N/A'">
														Área
														</td-->
															<!--td th:text="${entrada.areaJobs?.nomArea} ?: 'N/A'">
														Área
														</td-->
															<td>
																<span class="text-muted small"
																	th:text="${entrada.horaIngreso}">
																	EntradaRegistro
																</span>
																<br>
																<!--span class="fw-medium"
																th:text="${#dates.format(entrada.horaIngreso, 'HH:mm')}">
																Hora
															</span-->
															</td>
															<td>
																<span
																	th:if="${entrada.estadoPermanencia?.idestadoPermanencia == 1}"
																	class="badge bg-success bg-opacity-25 text-success px-3 py-2 border border-success">
																	<i class="bi bi-check-circle me-1"></i> Presente
																</span>
																<span
																	th:if="${entrada.estadoPermanencia?.idestadoPermanencia == 2}"
																	class="badge bg-dark bg-opacity-25 text-muted px-3 py-2 border border-muted">
																	<i class="bi bi-x-circle me-1"></i> Ausente
																</span>
																<!--span
																th:if="${entrada.estadoPermanencia?.nombre != 'Presente' and entrada.estadoPermanencia?.nombre != 'Ausente'}"
																class="badge bg-secondary bg-opacity-25 text-secondary px-3 py-2 border border-secondary">
																<i class="bi bi-question-circle me-1"></i>
																<span
																	th:text="${entrada.estadoPermanencia?.nombre} ?: 'No definido'"></span>
															</span-->
															</td>
															<!--td class="text-center">
															<div class="btn-group btn-group-sm" role="group">
																<a th:href="@{'/acceso/editar/' + ${entrada.idacceso}}"
																	class="btn btn-outline-info" title="Editar entrada">
																	<i class="bi bi-pencil-square"></i>
																</a>
																<a th:href="@{'/acceso/eliminar/' + ${entrada.idacceso}}"
																	class="btn btn-outline-secondary"
																	onclick="return confirm('¿Seguro que deseas eliminar esta entrada?');"
																	title="Eliminar entrada">
																	<i class="bi bi-trash"></i>
																</a>
															</div>
														</td-->
														</tr>
													</tbody>
												</table>
											</div>
										</div>
									</div>

									<!-- Contador de estados -->
									<div class="mt-3 d-flex justify-content-between align-items-center">
										<small class="text-muted">
											<i class="bi bi-info-circle me-1"></i>
											Mostrando <strong th:text="${accesos.size()}">0</strong> registros
										</small>
										<small class="text-muted">
											<strong>Última actualización:</strong> <span
												th:text="${#dates.createNow()}">Ahora</span>
										</small>
									</div>
								</div>

								<!-- Mostrar ALERTA si no hay datos -->
								<div th:if="${accesos != null and accesos.empty}" class="text-center py-5">
									<div class="alert alert-info border-info">
										<i class="bi bi-inbox me-2 fs-2 text-info"></i>
										<h4 class="alert-heading mt-3">No hay registros de entradas</h4>
										<p class="mb-0">No se encontraron entradas recientes en el sistema.</p>
										<hr>
										<small class="text-muted">Las entradas se actualizaran si se registra el acceso
											de
											aprendices a
											las instalaciones</small>
									</div>
								</div>

								<!-- Mostrar MENSAJE INICIAL si no se ha cargado nada -->
								<div th:if="${accesos == null}">
									<h4 class="text-success">
										<i class="bi bi-house me-2"></i><b> Últimas Entradas</b>
									</h4>
									<p class="text-muted">Seleccione "Últimas Entradas" en el menú lateral para cargar
										los
										registros recientes.</p>
								</div>

							</div>
						</div>
			</section>

			<!-- Footer -->
			<div th:insert="~{/templates_usuario.html::footer}"></div>

		</main>

		<!-- Archivos JS -->
		<div th:insert="~{/templates_usuario.html::jsFiles}"></div>

</body>

</html>