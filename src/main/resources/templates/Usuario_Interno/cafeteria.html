<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="utf-8">
    <title>Cafetería - TechAccess</title>
    <link href="assets/vendor/bootstrap/css/bootstrap.min.css" rel="stylesheet">
    <link href="assets/css/main.css" rel="stylesheet">
    <link rel="icon" type="image/x-icon" href="assets\img\cafesito.png">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.1/font/bootstrap-icons.css">
    <!-- FullCalendar CSS -->
    <link href='https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.css' rel='stylesheet' />
    <style>
        :root {
            --primary-green: #2e7d32;
            --secondary-green: #388e3c;
            --light-green: #81c784;
            --lighter-green: #e8f5e9;
            --dark-green: #1b5e20;
        }

        html,
        body {
            height: 100%;
            background-color: #f5f9f5;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            display: flex;
            flex-direction: column;
        }

        main {
            flex: 1;
            padding-bottom: 60px;
        }

        .badge-cafeteria {
            background: var(--lighter-green);
            color: var(--dark-green);
            font-weight: 500;
            padding: 5px 10px;
            border-radius: 20px;
        }

        .nav-cafeteria .nav-link {
            color: #000000;
            transition: all 0.3s ease;
            border-left: 3px solid transparent;
        }

        .nav-cafeteria .nav-link:hover {
            background-color: var(--lighter-green);
            color: var(--dark-green);
        }

        .nav-cafeteria .nav-link.active {
            border-left: 3px solid var(--primary-green);
            background: var(--lighter-green);
            color: var(--dark-green);
            font-weight: 500;
        }

        .nav-cafeteria .nav-link i {
            margin-right: 8px;
            color: var(--secondary-green);
        }

        header {
            border-bottom: 2px solid var(--light-green);
        }

        h1 strong {
            color: var(--primary-green);
        }

        .card {
            border: none;
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            margin-bottom: 20px;
            overflow: visible;
        }

        .card:hover {
            transform: translateY(-6px);
            box-shadow: 0 8px 15px rgba(1, 63, 32, 0.1);
        }

        .card h5 {
            color: var(--dark-green);
            font-weight: 600;
        }

        .text-center .card {
            padding: 15px 0;
            background-color: var(--lighter-green);
        }

        .text-center .card i {
            font-size: 1.5rem;
            color: var(--primary-green);
        }

        .text-center .card h5 {
            margin-top: 10px;
            color: var(--dark-green);
        }

        .text-center .card small {
            color: #000000;
            font-size: 0.8rem;
        }

        main .card:first-child {
            background-color: var(--lighter-green);
            padding: 20px;
        }

        main .card:first-child i {
            color: var(--primary-green);
            font-size: 2.5rem;
        }

        footer {
            background-color: var(--dark-green);
            color: white;
            padding: 20px 0;
            margin-top: auto;
            width: 100%;
        }

        .copyright {
            font-size: 0.9rem;
        }

        .sitename {
            color: var(--light-green);
        }

        #calendar-container {
            display: none;
            margin-top: 20px;
        }

        #calendar {
            max-height: 600px;
            background-color: white;
            border-radius: 10px;
            padding: 20px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.05);
            width: 100%;
        }

        .fc-event {
            background-color: var(--primary-green);
            border-color: var(--primary-green);
            cursor: pointer;
        }

        .fc-event:hover {
            background-color: var(--secondary-green);
            border-color: var(--secondary-green);
        }

        .fc-toolbar-title {
            color: var(--dark-green);
            font-weight: 600;
        }

        .fc-button {
            background-color: var(--light-green) !important;
            border-color: var(--light-green) !important;
            color: white !important;
        }

        .fc-button:hover {
            background-color: var(--secondary-green) !important;
            border-color: var(--secondary-green) !important;
        }

        .modal-content {
            border: none;
        }

        .modal-header {
            background-color: var(--lighter-green);
            border-bottom: 1px solid var(--light-green);
        }

        .modal-title {
            color: var(--dark-green);
            font-weight: 600;
        }

        .btn-primary {
            background-color: var(--primary-green);
            border-color: var(--primary-green);
        }

        .btn-danger {
            background-color: #d32f2f;
            border-color: #d32f2f;
        }

        .btn-primary:hover {
            background-color: var(--dark-green);
            border-color: var(--dark-green);
        }
    </style>
</head>

<body class="bg-light">
    <header class="bg-white py-2 shadow-sm fixed-top">
        <div class="container d-flex justify-content-between align-items-center">
            <h1 class="fs-5 m-0"><strong>TECH</strong>ACCES</h1>
            <div>
                <span class="badge-cafeteria px-3 py-1"><i class="bi bi-cup-hot"></i> Cafetería</span>
                <i class="bi bi-person-circle ms-2 fs-5" style="color: var(--primary-green);"></i>
            </div>
        </div>
    </header>

    <main class="container pt-5 mt-4">
        <div class="row">
            <div class="col-md-3">
                <div class="card text-center mb-3">
                    <i class="bi bi-egg-fried fs-1" style="color: var(--primary-green);"></i>
                    <h5 class="mt-2 mb-0">Elba Stone</h5>
                    <small class="text-muted">Cafetería</small>
                </div>
                <div class="card">
                    <nav class="nav flex-column nav-cafeteria p-2">
                        <a class="nav-link active py-3" href="#" id="turno-link"><i class="bi bi-shop"></i> Turno
                            Mañana</a>
                        <a class="nav-link py-3" href="#" id="eventos-link"><i class="bi bi-calendar2-week"></i>
                            Eventos</a>
                        <a class="nav-link py-3" href="#" id="inventario-link"><i class="bi bi-box-seam"></i>
                            Inventario</a>
                    </nav>
                </div>
            </div>
            <div class="col-md-9">
                <!-- Contenido del turno mañana (visible por defecto) -->
                <div id="turno-content" class="card p-4">
                    <h5 class="d-flex align-items-center"><i class="bi bi-graph-up me-2"
                            style="color: var(--primary-green);"></i> Hoy</h5>
                    <div class="row text-center mt-3">
                        <div class="col-4">
                            <div class="card py-3">
                                <i class="bi bi-cup-straw" style="color: var(--primary-green);"></i>
                                <h5 class="mt-2">47</h5>
                                <small>Bebidas</small>
                            </div>
                        </div>
                        <div class="col-4">
                            <div class="card py-3">
                                <i class="bi bi-egg-fried" style="color: var(--primary-green);"></i>
                                <h5 class="mt-2">23</h5>
                                <small>Snacks</small>
                            </div>
                        </div>
                        <div class="col-4">
                            <div class="card py-3">
                                <i class="bi bi-currency-dollar" style="color: var(--primary-green);"></i>
                                <h5 class="mt-2">$1,245</h5>
                                <small>Ventas</small>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Contenedor del calendario (oculto inicialmente) -->
                <div id="calendar-container" class="card p-4">
                    <h5 class="d-flex align-items-center"><i class="bi bi-calendar2-week me-2"
                            style="color: var(--primary-green);"></i> Calendario de Eventos</h5>
                    <div id="calendar" class="mt-3"></div>
                </div>

                <!-- Contenedor del inventario (oculto inicialmente) -->
                <div id="inventario-content" class="card p-4" style="display: none;">
                    <h5 class="d-flex align-items-center"><i class="bi bi-box-seam me-2"
                            style="color: var(--primary-green);"></i> Inventario</h5>
                    <!-- Contenido del inventario -->
                </div>
            </div>
        </div>
    </main>

    <!-- Modal para agregar/editar eventos -->
    <div class="modal fade" id="eventModal" tabindex="-1" aria-labelledby="eventModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="eventModalLabel">Nuevo Evento</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    <form id="eventForm">
                        <div class="mb-3">
                            <label for="eventTitle" class="form-label">Título del Evento</label>
                            <input type="text" class="form-control" id="eventTitle" required>
                        </div>
                        <div class="mb-3">
                            <label for="eventDate" class="form-label">Fecha</label>
                            <input type="date" class="form-control" id="eventDate" required>
                        </div>
                        <div class="mb-3">
                            <label for="eventDescription" class="form-label">Descripción</label>
                            <textarea class="form-control" id="eventDescription" rows="3"></textarea>
                        </div>
                        <div class="mb-3">
                            <label for="eventColor" class="form-label">Color</label>
                            <select class="form-select" id="eventColor">
                                <option value="#2e7d32" selected>Verde</option>
                                <option value="#1976d2">Azul</option>
                                <option value="#d32f2f">Rojo</option>
                                <option value="#ffa000">Naranja</option>
                            </select>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-danger me-auto" id="deleteEvent"
                        style="display: none;">Eliminar</button>
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <button type="button" class="btn btn-primary" id="saveEvent">Guardar</button>
                </div>
            </div>
        </div>
    </div>

    <footer>
        <div class="container copyright text-center mt-4">
            <p>© <span>Copyright</span> <strong class="px-1 sitename">TechAccess</strong> <span>Todos los derechos
                    reservados</span></p>
        </div>
    </footer>

    <!-- Scripts -->
    <script src="assets/vendor/bootstrap/js/bootstrap.bundle.min.js"></script>
    <!-- FullCalendar JS -->
    <script src='https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/main.min.js'></script>
    <script src='https://cdn.jsdelivr.net/npm/fullcalendar@5.11.3/locales/es.js'></script>

    <script>
        document.addEventListener('DOMContentLoaded', function () {
            // Elementos del DOM
            const turnoLink = document.getElementById('turno-link');
            const eventosLink = document.getElementById('eventos-link');
            const inventarioLink = document.getElementById('inventario-link');

            const turnoContent = document.getElementById('turno-content');
            const calendarContainer = document.getElementById('calendar-container');
            const calendarEl = document.getElementById('calendar');
            const inventarioContent = document.getElementById('inventario-content');

            // Inicializar calendario
            const calendar = new FullCalendar.Calendar(calendarEl, {
                initialView: 'dayGridMonth',
                locale: 'es',
                headerToolbar: {
                    left: 'prev,next today',
                    center: 'title',
                    right: 'dayGridMonth,timeGridWeek,timeGridDay'
                },
                dateClick: function (info) {
                    // Abrir modal para agregar evento al hacer clic en una fecha
                    document.getElementById('eventModalLabel').textContent = 'Nuevo Evento';
                    document.getElementById('eventTitle').value = '';
                    document.getElementById('eventDate').value = info.dateStr;
                    document.getElementById('eventDescription').value = '';
                    document.getElementById('eventColor').value = '#2e7d32';
                    document.getElementById('deleteEvent').style.display = 'none';

                    const eventModal = new bootstrap.Modal(document.getElementById('eventModal'));
                    eventModal.show();
                },
                eventClick: function (info) {
                    // Mostrar detalles del evento al hacer clic en él
                    document.getElementById('eventModalLabel').textContent = 'Editar Evento';
                    document.getElementById('eventTitle').value = info.event.title;
                    document.getElementById('eventDate').value = info.event.startStr.split('T')[0];
                    document.getElementById('eventDescription').value = info.event.extendedProps.description || '';
                    document.getElementById('eventColor').value = info.event.backgroundColor || '#2e7d32';
                    document.getElementById('deleteEvent').style.display = 'block';

                    const eventModal = new bootstrap.Modal(document.getElementById('eventModal'));
                    eventModal.show();

                    // Guardar referencia al evento que se está editando
                    document.getElementById('saveEvent').dataset.eventId = info.event.id;
                    document.getElementById('deleteEvent').dataset.eventId = info.event.id;
                }
            });

            // Renderizar calendario después de que el contenedor esté visible
            function renderCalendar() {
                calendar.render();
                calendar.updateSize();
            }

            // Manejar clics en los enlaces del menú
            turnoLink.addEventListener('click', function (e) {
                e.preventDefault();
                setActiveLink(this);
                turnoContent.style.display = 'block';
                calendarContainer.style.display = 'none';
                inventarioContent.style.display = 'none';
            });

            eventosLink.addEventListener('click', function (e) {
                e.preventDefault();
                setActiveLink(this);
                turnoContent.style.display = 'none';
                calendarContainer.style.display = 'block';
                inventarioContent.style.display = 'none';

                // Renderizar calendario cuando se muestra el contenedor
                setTimeout(renderCalendar, 10);
            });

            inventarioLink.addEventListener('click', function (e) {
                e.preventDefault();
                setActiveLink(this);
                turnoContent.style.display = 'none';
                calendarContainer.style.display = 'none';
                inventarioContent.style.display = 'block';
            });

            // Función para establecer el enlace activo
            function setActiveLink(activeLink) {
                const navLinks = document.querySelectorAll('.nav-cafeteria .nav-link');
                navLinks.forEach(link => {
                    link.classList.remove('active');
                });
                activeLink.classList.add('active');
            }

            // Manejar el guardado de eventos
            document.getElementById('saveEvent').addEventListener('click', function () {
                const title = document.getElementById('eventTitle').value;
                const date = document.getElementById('eventDate').value;
                const description = document.getElementById('eventDescription').value;
                const color = document.getElementById('eventColor').value;

                if (title && date) {
                    const eventData = {
                        title: title,
                        start: date,
                        description: description,
                        backgroundColor: color,
                        borderColor: color
                    };

                    // Si estamos editando un evento existente
                    if (this.dataset.eventId) {
                        const event = calendar.getEventById(this.dataset.eventId);
                        event.setProp('title', title);
                        event.setStart(date);
                        event.setExtendedProp('description', description);
                        event.setProp('backgroundColor', color);
                        event.setProp('borderColor', color);
                    } else {
                        // Agregar nuevo evento
                        calendar.addEvent(eventData);
                    }

                    // Cerrar el modal
                    bootstrap.Modal.getInstance(document.getElementById('eventModal')).hide();
                    this.dataset.eventId = '';
                }
            });

            // Manejar la eliminación de eventos - VERSIÓN CORREGIDA
            document.getElementById('deleteEvent').addEventListener('click', function () {
                const eventId = this.dataset.eventId;
                if (eventId) {
                    if (confirm('¿Estás seguro de que quieres eliminar este evento?')) {
                        const event = calendar.getEventById(eventId);
                        if (event) {
                            event.remove();
                            // Mostrar mensaje de éxito
                            alert('Evento eliminado correctamente');
                        } else {
                            alert('No se encontró el evento a eliminar');
                        }
                        bootstrap.Modal.getInstance(document.getElementById('eventModal')).hide();
                    }
                } else {
                    alert('No se ha seleccionado ningún evento para eliminar');
                }
            });

            // Limpiar datos al cerrar el modal
            document.getElementById('eventModal').addEventListener('hidden.bs.modal', function () {
                document.getElementById('saveEvent').dataset.eventId = '';
                document.getElementById('deleteEvent').dataset.eventId = '';
                document.getElementById('deleteEvent').style.display = 'none';
            });

            // Renderizar calendario por primera vez
            renderCalendar();
        });
    </script>
</body>

</html>