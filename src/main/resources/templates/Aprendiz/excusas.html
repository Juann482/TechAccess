<!DOCTYPE html>
<html lang="es" xmlns:th="http://www.thyme5.org">

<head th:insert="~{/Aprendiz/templates_aprendiz.html::head}"></head>

<body class="contact-page">
	<div th:insert="~{/Aprendiz/templates_aprendiz.html::header}"></div>
	<div th:insert="~{/Aprendiz/templates_aprendiz.html::style}"></div>


	<!-- Contenido principal -->
	<main class="main" style="background-color: rgba(0, 124, 88, 0.05); min-height: 100vh;">

		<div class="page-title dark-background text-center"
			th:style="'background-image: url(' + @{/images/fondo.jpeg} + '); background-size: cover; background-position: center; padding-top: 150px; padding-bottom: 50px;'">
			<div class="container position-relative">
				<h1 class="text-white fw-bold mb-3">Excusas</h1>
			</div>
		</div>

		<div class="container py-5">
			<div class="row g-4"></div>
		</div>
			<div class="page-title black-background text-center py-5">
				<div class="container position-relative">
					<div class="container">
						<div class="row">

							<!-- FORMULARIO DE EXCUSAS -->
							<div class="col-lg-11 mx-auto px-4">
								<div class="access-card bg-white rounded-3 shadow-sm p-4" style="opacity: 0.95;">
									<section class="section dashboard">
										<div class="card-body">

											<h4 class="mb-3" style="color: rgb(14, 209, 220);">
												<i class="bi bi-clipboard-check me-2"
													style="color: rgb(14, 209, 220);"></i>
												<b>Registrar Excusa</b>
											</h4>

											<div th:if="${error}" class="alert alert-danger mt-3"
												style="color: rgb(14, 209, 220);" th:text="${error}"></div>

											<!-- FORMULARIO REAL -->
											<form th:action="@{/Aprendiz/save}" method="post"
												enctype="multipart/form-data" id="formExcusa">

												<div class="mb-3 row" style="color: rgb(14, 209, 220)">
													<label class="col-sm-3 col-form-label fw-semibold">Nombre y
														apellidos:</label>
													<div class="col-sm-9">
														<input type="text" class="form-control" id="nombres"
															name="nombres"
															th:value="${usuario != null ? usuario.nombre : ' - '}"
															readonly>
													</div>
												</div>

												<div class="mb-3 row" style="color: rgb(14, 209, 220)">
													<label
														class="col-sm-3 col-form-label fw-semibold">Documento:</label>
													<div class="col-sm-9">
														<input type="number" class="form-control" id="ndocumento"
															name="ndocumento"
															th:value="${usuario != null ? usuario.documento : ' - '}"
															readonly>
													</div>
												</div>

												<div class="mb-3 row" style="color: rgb(14, 209, 220)">
													<label class="col-sm-3 col-form-label fw-semibold">Número de
														ficha:</label>
													<div class="col-sm-9">
														<input type="number" class="form-control mb-2" id="fichaasd"
															name="fichaasd"
															th:value="${ficha != null ? ficha.numFicha : ' - '}"
															readonly>

														<input type="hidden" th:name="ficha.id"
															th:value="${ficha != null ? ficha.id : 0}">
													</div>
												</div>

												<div class="mb-3 row" style="color: rgb(14, 209, 220)">
													<label class="col-sm-3 col-form-label fw-semibold">Motivo de
														inasistencia:</label>
													<div class="col-sm-9">
														<select class="form-control" id="motivo" name="motivo" required>
															<option value="">*** Seleccionar ***</option>
															<option value="Enfermedad">Enfermedad</option>
															<option value="Incapacidad médica">Incapacidad médica
															</option>
															<option value="Derecho al voto">Derecho al voto</option>
															<option value="Calamidad doméstica">Calamidad doméstica
															</option>
															<option value="Otro">Otro</option>
														</select>
													</div>
												</div>

												<div class="mb-3 row" style="color: rgb(14, 209, 220)">
													<label
														class="col-sm-3 col-form-label fw-semibold">Descripción:</label>
													<div class="col-sm-9">
														<input type="text" class="form-control" id="descripcion"
															name="descripcion" placeholder="Motivo de inasistencia"
															autocomplete="off">
													</div>
												</div>

												<div class="mb-3 row" style="color: rgb(14, 209, 220)">
													<label class="col-sm-3 col-form-label fw-semibold">Fecha:</label>
													<div class="col-sm-9">
														<input type="date" class="form-control" id="fecha" name="fecha"
															required>
													</div>
												</div>

												<div class="mb-3 row" style="color: rgb(14, 209, 220)">
													<label class="col-sm-3 col-form-label fw-semibold">Soporte:</label>
													<div class="col-sm-9">
														<input type="file" class="form-control" name="img"
															accept=".pdf,.jpg,.png" required>
														<small class="text-muted">Adjunte un soporte en PDF o
															imagen.</small>
													</div>
												</div>

												<div class="text-end mt-4">
													<button type="button" class="btn"
														style="background-color: rgb(14, 209, 220); border-color: rgb(14, 209, 220); color: white;"
														onclick="confirmarGuardado()">
														<i class="bi bi-send-plus me-2"></i> Guardar Excusa
													</button>
												</div>

											</form>

										</div>
									</section>
								</div>
							</div>

						</div>
					</div>
				</div>
	</main>

	<!-- MODAL PERFIL -->
	<div th:insert="~{/Aprendiz/templates_aprendiz.html::modal}"></div>

	<!-- FOOTER Y JS COMUNES -->
	<div th:insert="~{/Aprendiz/templates_aprendiz.html::footer}"></div>
	<div th:insert="~{/Aprendiz/templates_aprendiz.html::jsFiles}"></div>

	<!-- Scripts específicos -->
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.0/dist/js/bootstrap.bundle.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
	<script>
		function confirmarGuardado() {
			Swal.fire({
				title: "¿Guardar excusa?",
				text: "La información será registrada en el sistema.",
				icon: "question",
				showCancelButton: true,
				confirmButtonText: "Guardar",
				cancelButtonText: "Cancelar",
				buttonsStyling: false,
				customClass: {
					popup: 'rounded-4 shadow',
					title: 'fw-bold',
					confirmButton: 'btn btn-outline-secondary px-4 rounded-pill',
					cancelButton: 'btn btn-outline-secondary px-4 rounded-pill'
				}
			}).then((result) => {
				if (result.isConfirmed) {
					Swal.fire({
						icon: "success",
						title: "Excusa guardada",
						text: "La excusa se registró correctamente.",
						showConfirmButton: false,
						timer: 1500,
						customClass: { popup: 'rounded-4 shadow' }
					}).then(() => {
						document.getElementById("formExcusa").submit();
					});
				}
			});
		}
	</script>


</body>

</html>